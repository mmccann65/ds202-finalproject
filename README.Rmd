---
title: ""
author: "Madison McCann"
date: "2025-12-08"
output: github_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(tidyverse)

df <- read.csv("top-500-novels-metadata_2025-01-11.csv")

df <- df |>
  mutate(
    publication_century = case_when(
      pub_year <= 1700 ~ "17th Century and Earlier",
      pub_year <= 1800 ~ "18th Century",
      pub_year <= 1900 ~ "19th Century",
      pub_year <= 2000 ~ "20th Century",
      TRUE ~ "21st Century"
    )
  )

century_order <- c("17th Century and Earlier", "18th Century", "19th Century", "20th Century", "21st Century")
df$publication_century <- factor(df$publication_century, levels = century_order, ordered = TRUE)

```

```{r}
#ANALYSIS QUESTION 1: How has the distribution of top-ranked novel's publication years changed over time?

century_counts <- df |>
  count(publication_century, name = "novel_count")

print("Novel Counts by Publication Century:")
print (century_counts)
```

```{r}
#VISUAL 1: BAR CHART OF NOVELS BY PUBLICATION CENTURY
pub_year_plot <- ggplot(century_counts, aes(x = publication_century, y = novel_count, fill = publication_century)) +
  geom_bar(stat = "identity") +
  geom_text(aes(label = novel_count), vjust = -0.5, size = 3) +
  labs(
    title = "Distribution of Top 500 Novels by Publication Century",
    x = "Publication Century",
    y = "Number of Novels",
    fill = "Century"
  ) +
  theme_minimal() +
  theme(
    axis.text.x = element_text(angle = 45, hjust = 1),
    legend.position = "none"
  )

ggsave("novels_by_century_bar_char.png", plot = pub_year_plot, width = 7, height = 5)

```

```{r}
#ANALYSIS QUESTION 2: Is there a relationship between a novel's genre and its Goodreads Average Rating?

top_genres <- df |>
  count(genre, sort = TRUE)|>
  slice_head(n = 5)|>
  pull(genre)

df_top_genres <- df |>
  filter(genre %in% top_genres)

df_top_genres$genre <- factor(df_top_genres$genre, levels = rev(top_genres))

```

```{r}
#VISUAL 2: BOX PLOT OF AVERAGE RATING BY TOP 5 GENRE

genre_rating_plot <- ggplot(df_top_genres, aes(x = gr_avg_rating, y = genre, fill = genre)) +
  geom_boxplot() +
  labs(
    title = "Goodreads Average Taing Distribtuion for Top 5 Genres"
  )
```


